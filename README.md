Проект реализует систему клиент-сервер на языке C++20, которая позволяет детектировать объекты на изображении, согласно правилам фильтрации по полигональным областям.
Состоит из:
1. Клиент. Программа, считывающая изображения из файла и полигоны, форматирует в формат .jpg и отправляет на сервер. Затем, выводит ответное изображение, с детектированными объектами, от сервера на экран.
2. Сервер. Программа принимающая изображение и полигоны от клиента, детектирует объекты на изображении, создает бинарные маски полигонов, ищет полигоны, пересекающиеся с объектом, смотрит количество пикселей в области пеперсечения, и в зависимости от правил площади пересечения, обводит объект или игнорирует. Итоговое изображение отсылает обратно клиенту.
### Перед запуском проекта, выполните команды в терминале
```bash
xhost +local:docker #разрешение подключения к X-серверу из контейнеров
```
**Warning**
Docker-desktop в ubuntu, может некорректно выставлять права доступа. Лучше испольвать docker-engine 

### Cборка проекта в режиме разработки
Для сборки в режиме разработки понадобится docker и vscode с установленным расширением Dev Containers от Microsoft.
Так же необходимо отдельно скачать `yolov4.weights` file 245 MB: [yolov4.weights](https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.weights) и поместитьт его в корень проекта, в папку YOLO.

Откройте проект в `Visual Studio Code`.
Нажмите `F1` и откройте проект в dev-контейнере командой `Dev Containers: Reopen in Container`.
После этого будет создан контейнер со всеми зависимостями.
В терминале контейнера нужно выполнить:

```bash
mkdir build && cd build
cmake ..
make
```
После этого проект будет собран.

Команда запуска тестов из корня проекта:
```bash
./build/tests/run_tests
```

Клиент и сервер поддерживают аргументы запуска.

Для запуска сервера

```bash
cd build/src/server/
./server #Запуск сервера
./server -h #Вывод списка доступных аргументов
./server -p #Засупуск сервера с отоборажением полигонов, в результирующем изображении
```
Для запуска клиента

```bash
cd build/src/client/
./client #Запуск клиента с изображнием 2.jpg и полигонами 2.json из папки image в корне проекта
./client -h #Вывод списка доступных аргументов
./client -i <Файл изображения> -p <Файл с полигонами> #Засупуск клиента с заданными пользователем изображением и набором полигонов
```

Примеры полигонов и изображений можно найти в папке image в корне проекта.

### Набор полигонов JSON
Каждый полигон описывается объектом со следующими полями:
- `type` (integer) — тип полигона: 0 – включающий, 1 – исключающий.
- `priority` (integer) – приоритет обработки (чем больше, тем выше).
- `threshold` (float) – пороговое значение для детекции.
- `points` (array) – массив точек с координатами `x` и `y`.


### Пример набора полигонов JSONм
```json
{
  "polygons": [
    {
      "type": 0,
      "priority": 10,
      "threshold": 0.6,
      "points": [
        {"x": 10, "y": 10},
        {"x": 900, "y": 10},
        {"x": 900, "y": 800},
        {"x": 10, "y": 800}
      ]
    }, 
    {
      "type": 1,
      "priority": 10,
      "threshold": 0.5,
      "points": [
        {"x": 500, "y": 500},
        {"x": 800, "y": 500},
        {"x": 800, "y": 800},
        {"x": 500, "y": 800},
        {"x": 10, "y": 700}
      ]
    }
  ]
}
```
